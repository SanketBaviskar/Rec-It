import{g as C,r as l,j as e,L as re,h as ne,i as le,k as ie,l as S,T as ce,O as de,W as ue,m as pe,n as me,o as fe,p as ge,q as R,R as xe,s as he,f as v,t as I,v as ve,w as ye,B as Ne,x as je,y as Ae,I as we,z as De}from"./index-bC756Pjy.js";import{d as be}from"./deleteEquipment-CIWO1BG8.js";/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=C("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.456.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=C("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Re=({categories:t,onAddEquipment:s,onDeleteEquipment:a,onDeleteCategory:r,onOpenEquipment:n,isLoading:d=!1})=>{const[p,N]=l.useState(new Set),[x,c]=l.useState(null),[m,w]=l.useState(null),j=l.useRef(null);l.useEffect(()=>{const o=h=>{j.current&&!j.current.contains(h.target)&&c(null)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const A=o=>{N(h=>new Set(h).has(o)?new Set([...h].filter(D=>D!==o)):new Set([...h,o]))},i=o=>{o.equipments&&o.equipments.length>0?A(o.id):w({name:o.name,id:o.id})},u=o=>{var D;const h=o.equipments&&o.equipments.length>0;return e.jsxs("div",{className:"group relative",children:[e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1.5 cursor-pointer hover:bg-accent",onClick:()=>i(o),onKeyDown:f=>f.key==="Enter"&&i(o),tabIndex:0,children:[h?e.jsx(ne,{className:`h-4 w-4 transition-transform ${p.has(o.id)?"rotate-90":""}`}):e.jsx("div",{className:"w-4"}),e.jsx("span",{className:"ml-1",children:o.name}),s&&e.jsx("div",{className:"p-2 hover:bg-accent/50 rounded-sm ml-auto",onClick:f=>{f.stopPropagation(),c(x===o.id?null:o.id)},children:e.jsx(Ce,{className:"h-4 w-4"})})]}),x===o.id&&e.jsxs("div",{ref:j,className:"absolute left-full top-0 ml-1 z-10 bg-white shadow-lg rounded-md p-2 border min-w-[200px]",children:[e.jsx("div",{className:"px-4 py-2 hover:bg-gray-100 rounded-md cursor-pointer text-sm",onClick:()=>{s==null||s(o.id,o.name),c(null)},children:"Add Equipment"}),r&&e.jsx("div",{className:"px-4 py-2 hover:bg-gray-100 rounded-md cursor-pointer text-sm text-destructive font-medium",onClick:()=>{r(o.id),c(null)},children:"Delete Inventory"})]}),p.has(o.id)&&h&&e.jsx("div",{className:"ml-4",children:(D=o.equipments)==null?void 0:D.map(f=>e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1.5 hover:bg-accent cursor-pointer group",children:[e.jsx("span",{className:"ml-4 flex-1",onClick:()=>{n==null||n(f.id)},children:f.name}),e.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-accent/50 rounded-sm",onClick:async ae=>{ae.stopPropagation();try{await be(f.id),a==null||a(f.id)}catch(oe){console.error("Failed to delete equipment:",oe)}},children:e.jsx(Se,{className:"h-4 w-4"})})]},f.id))})]},o.id)};return e.jsxs("div",{className:"space-y-1",role:"tree",children:[m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Category Details"}),e.jsxs("p",{className:"font-medium",children:["Name: ",m.name]}),e.jsx("button",{onClick:()=>w(null),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Close"})]})}),d?e.jsxs("div",{className:"p-2 text-sm flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading categories..."})]}):t.length>0?t.map(u):e.jsx("p",{className:"text-sm px-2",children:"No categories available"})]})},Ie=async t=>{try{return(await le.delete(`/inventories/${t}`)).data}catch(s){throw console.error("Error deleting inventory:",s),s}};function b(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Pe(...t){return s=>{let a=!1;const r=t.map(n=>{const d=b(n,s);return!a&&typeof d=="function"&&(a=!0),d});if(a)return()=>{for(let n=0;n<r.length;n++){const d=r[n];typeof d=="function"?d():b(t[n],null)}}}}function P(...t){return l.useCallback(Pe(...t),t)}function _e(t,s,{checkForDefaultPrevented:a=!0}={}){return function(n){if(t==null||t(n),a===!1||!n.defaultPrevented)return s==null?void 0:s(n)}}var _="AlertDialog",[ke,Ye]=ie(_,[S]),g=S(),k=t=>{const{__scopeAlertDialog:s,...a}=t,r=g(s);return e.jsx(xe,{...r,...a,modal:!0})};k.displayName=_;var Te="AlertDialogTrigger",Ee=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,n=g(a);return e.jsx(ce,{...n,...r,ref:s})});Ee.displayName=Te;var Me="AlertDialogPortal",T=t=>{const{__scopeAlertDialog:s,...a}=t,r=g(s);return e.jsx(he,{...r,...a})};T.displayName=Me;var Oe="AlertDialogOverlay",E=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,n=g(a);return e.jsx(de,{...n,...r,ref:s})});E.displayName=Oe;var y="AlertDialogContent",[$e,Le]=ke(y),M=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,children:r,...n}=t,d=g(a),p=l.useRef(null),N=P(s,p),x=l.useRef(null);return e.jsx(ue,{contentName:y,titleName:O,docsSlug:"alert-dialog",children:e.jsx($e,{scope:a,cancelRef:x,children:e.jsxs(pe,{role:"alertdialog",...d,...n,ref:N,onOpenAutoFocus:_e(n.onOpenAutoFocus,c=>{var m;c.preventDefault(),(m=x.current)==null||m.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[e.jsx(me,{children:r}),e.jsx(ze,{contentRef:p})]})})})});M.displayName=y;var O="AlertDialogTitle",$=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,n=g(a);return e.jsx(fe,{...n,...r,ref:s})});$.displayName=O;var L="AlertDialogDescription",F=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,n=g(a);return e.jsx(ge,{...n,...r,ref:s})});F.displayName=L;var Fe="AlertDialogAction",z=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,n=g(a);return e.jsx(R,{...n,...r,ref:s})});z.displayName=Fe;var V="AlertDialogCancel",W=l.forwardRef((t,s)=>{const{__scopeAlertDialog:a,...r}=t,{cancelRef:n}=Le(V,a),d=g(a),p=P(s,n);return e.jsx(R,{...d,...r,ref:p})});W.displayName=V;var ze=({contentRef:t})=>{const s=`\`${y}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${y}\` by passing a \`${L}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${y}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return l.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},Ve=k,We=T,q=E,B=M,G=z,Q=W,Y=$,K=F;const qe=Ve,Be=We,J=l.forwardRef(({className:t,...s},a)=>e.jsx(q,{className:v("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:a}));J.displayName=q.displayName;const U=l.forwardRef(({className:t,...s},a)=>e.jsxs(Be,{children:[e.jsx(J,{}),e.jsx(B,{ref:a,className:v("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));U.displayName=B.displayName;const X=({className:t,...s})=>e.jsx("div",{className:v("flex flex-col space-y-2 text-center sm:text-left",t),...s});X.displayName="AlertDialogHeader";const Z=({className:t,...s})=>e.jsx("div",{className:v("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Z.displayName="AlertDialogFooter";const H=l.forwardRef(({className:t,...s},a)=>e.jsx(Y,{ref:a,className:v("text-lg font-semibold",t),...s}));H.displayName=Y.displayName;const ee=l.forwardRef(({className:t,...s},a)=>e.jsx(K,{ref:a,className:v("text-sm text-muted-foreground",t),...s}));ee.displayName=K.displayName;const te=l.forwardRef(({className:t,...s},a)=>e.jsx(G,{ref:a,className:v(I(),t),...s}));te.displayName=G.displayName;const se=l.forwardRef(({className:t,...s},a)=>e.jsx(Q,{ref:a,className:v(I({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));se.displayName=Q.displayName;function Ke(){const{toast:t}=ve(),[s,a]=l.useState(null),[r,n]=l.useState({}),[d,p]=l.useState(""),[N,x]=l.useState([]),[c,m]=l.useState(null),w=i=>{console.log("Selected category ID:",i)};l.useEffect(()=>{A()},[]);const j=async()=>{var i,u;if(c)try{const o=await Ie(c);t({title:o.status==="success"?"Success":"Error",description:o.message||"Inventory deleted successfully",variant:o.status==="success"?"default":"destructive"}),await A()}catch(o){t({title:"Error",description:((u=(i=o.response)==null?void 0:i.data)==null?void 0:u.message)||"Failed to delete inventory",variant:"destructive"}),console.error("Delete inventory error:",o)}finally{m(null)}},A=async()=>{var i;try{const u=await ye({ts:Date.now()});u.status==="success"&&x(((i=u.data)==null?void 0:i.items)||[])}catch(u){console.error("Error loading categories:",u),x([])}};return e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-64 border-r bg-background p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"font-semibold",children:"Inventory List"}),e.jsx(Ne,{variant:"outline",size:"icon",onClick:()=>a("AddNewInventoryForm"),"aria-label":"Add New Inventory",children:e.jsx(je,{className:"h-4 w-4"})})]}),e.jsx(Re,{categories:N,onCategorySelect:w,onAddEquipment:(i,u)=>{a("AddNewEquipmentForm"),n({categoryId:i,categoryName:u,mode:"create"})},onOpenEquipment:i=>{a("Equipment"),n({equipmentId:i})},onDeleteCategory:i=>m(i)})]}),e.jsxs("div",{className:"flex-1 p-6 h-full overflow-hidden",children:[!s&&e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"relative w-96",children:[e.jsx(Ae,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(we,{placeholder:"Search equipment...",className:"pl-8",value:d,onChange:i=>p(i.target.value)})]})}),e.jsx("div",{className:"h-full overflow-y-auto",children:s?e.jsx(De,{activeComponent:s,componentProps:{onComplete:()=>{a(null),A()},...s==="AddNewEquipmentForm"?{categoryId:r.categoryId,categoryName:r.categoryName,mode:r.mode}:{},...s==="Equipment"?{equipmentId:r.equipmentId}:{}}}):e.jsx("p",{className:"text-center text-muted-foreground",children:"Welcome to Inventory Management. Please select an action."})})]}),e.jsx(qe,{open:!!c,children:e.jsxs(U,{children:[e.jsxs(X,{children:[e.jsx(H,{children:"Are you absolutely sure?"}),e.jsx(ee,{children:"This action cannot be undone. This will permanently delete the inventory and remove all associated equipment."})]}),e.jsxs(Z,{children:[e.jsx(se,{onClick:()=>m(null),children:"Cancel"}),e.jsx(te,{onClick:j,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Inventory"})]})]})})]})}export{Ke as default};
